{"version":3,"file":"sycamore.js","sources":["../node_modules/knot.js/dist/knot.module.js","../src/sycamore.js"],"sourcesContent":["var _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar knot = function knot() {\n  var extended = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var events = Object.create(null);\n\n  function on(name, handler) {\n    events[name] = events[name] || [];\n    events[name].push(handler);\n    return this;\n  }\n\n  function once(name, handler) {\n    handler._once = true;\n    on(name, handler);\n    return this;\n  }\n\n  function off(name) {\n    var handler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    handler ? events[name].splice(events[name].indexOf(handler), 1) : delete events[name];\n\n    return this;\n  }\n\n  function emit(name) {\n    var _this = this;\n\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    // cache the events, to avoid consequences of mutation\n    var cache = events[name] && events[name].slice();\n\n    // only fire handlers if they exist\n    cache && cache.forEach(function (handler) {\n      // remove handlers added with 'once'\n      handler._once && off(name, handler);\n\n      // set 'this' context, pass args to handlers\n      handler.apply(_this, args);\n    });\n\n    return this;\n  }\n\n  return _extends({}, extended, {\n\n    on: on,\n    once: once,\n    off: off,\n    emit: emit\n  });\n};\n\nexport default knot;\n","import knot from 'knot.js'\n\nexport default class Sycamore {\n\n    /**\n        --- CONSTRUCTOR ---\n    **/\n\n    constructor (data, options = {}) {\n        this.emitter = knot()\n\n        let speed\n        if (options.speed && options.speed >= 1 && options.speed <= 10) {\n            speed = options.speed\n        } else {\n            speed = 5\n        }\n\n        this.options = {\n            speed: speed,\n            firstQuestion: options.firstQuestion || false\n        }\n\n        const averageCharactersPerSecond = 6\n        this.charactersPerSecond = (averageCharactersPerSecond * 2) * (this.options.speed / 10)\n\n        this.currentQuestion = false\n        this.answeredData = []\n\n        if (data instanceof Array) {\n            this.data = data\n        } else if (data) {\n            throw new Error(`Data is not an array.`)\n        }\n\n        return this\n    }\n\n    /**\n        --- API ---\n    **/\n\n    init (id) {\n        if (id) {\n            this._findAndAsk(id)\n        } else if (this.options.firstQuestion) {\n            this._findAndAsk(this.options.firstQuestion)\n        } else {\n            this._askQuestion(this.data[0])\n        }\n    }\n\n    answer (answer) {\n        this._answerQuestion(answer)\n    }\n\n    on (...args) { return this.emitter.on(...args) }\n    off (...args) { return this.emitter.off(...args) }\n\n    /**\n        --- CORE FUNCTIONS ---\n    **/\n\n    _findQuestionByID (id) {\n        return new Promise((resolve, reject) => {\n            this.data.forEach((obj) => {\n                if (obj.id === id) {\n                    resolve(obj)\n                }\n            })\n            reject('No question found')\n        })\n    }\n\n    _calculateWait (question) {\n        const characterLength = question.length\n        let wait = characterLength / this.charactersPerSecond\n        wait = wait * 1000\n        wait = Math.round(wait)\n        return wait\n    }\n\n    _askQuestion (obj) {\n        this.currentQuestion = obj\n        const wait = this._calculateWait(obj.question)\n\n        this.emitter.emit('typing', wait)\n\n        setTimeout(() => {\n            this.emitter.emit('question', obj)\n        }, wait)\n    }\n\n    _findAndAsk (id) {\n        this._findQuestionByID(id).then((obj) => {\n            this._askQuestion(obj)\n        }).catch((error) => {\n            throw new Error(error)\n        })\n    }\n\n    _answerQuestion (answer) {\n        const answeredQuestionData = {\n            question: this.currentQuestion.question,\n            answer: answer.text\n        }\n\n        this.answeredData.push(answeredQuestionData)\n\n        this.emitter.emit('update', this.answeredData)\n\n        if (answer.nextQuestion) {\n            this._findAndAsk(answer.nextQuestion)\n        } else {\n            this.emitter.emit('finished', this.answeredData)\n        }\n        \n        if (answer.callback) {\n            if (typeof answer.callback == 'function') {\n                answer.callback()\n            } else {\n                throw new Error(`The callback for '${answer.text}' is not a function`)\n            }\n        }\n    }\n}\n"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","knot","on","name","handler","events","push","this","once","_once","off","undefined","splice","indexOf","emit","_this","_len","args","Array","_key","cache","slice","forEach","apply","extended","create","Sycamore","data","options","emitter","speed","firstQuestion","averageCharactersPerSecond","charactersPerSecond","currentQuestion","answeredData","Error","id","_findAndAsk","_askQuestion","answer","_answerQuestion","Promise","resolve","reject","obj","question","characterLength","wait","Math","round","_calculateWait","_findQuestionByID","then","catch","error","answeredQuestionData","text","nextQuestion","callback"],"mappings":";;;;;;;;;mLAAA,IAAIA,GAAWC,OAAOC,QAAU,SAAUC,OACnC,GAAIC,GAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,IACrCG,GAASF,UAAUD,OAElB,GAAII,KAAOD,GACVN,OAAOQ,UAAUC,eAAeC,KAAKJ,EAAQC,OACxCA,GAAOD,EAAOC,UAKpBL,IAGLS,EAAO,mBAKAC,GAAGC,EAAMC,YACTD,GAAQE,EAAOF,SACfA,GAAMG,KAAKF,GACXG,aAGAC,GAAKL,EAAMC,YACVK,OAAQ,IACbN,EAAMC,GACFG,aAGAG,GAAIP,MACPC,GAAUV,UAAUC,OAAS,GAAsBgB,SAAjBjB,UAAU,IAAmBA,UAAU,YAEnEW,EAAOF,GAAMS,OAAOP,EAAOF,GAAMU,QAAQT,GAAU,SAAYC,GAAOF,GAEzEI,aAGAO,GAAKX,OAGP,GAFDY,GAAQR,KAEHS,EAAOtB,UAAUC,OAAQsB,EAAOC,MAAMF,EAAO,EAAIA,EAAO,EAAI,GAAIG,EAAO,EAAGA,EAAOH,EAAMG,MACzFA,EAAO,GAAKzB,UAAUyB,MAIzBC,GAAQf,EAAOF,IAASE,EAAOF,GAAMkB,kBAGhCD,EAAME,QAAQ,SAAUlB,KAEvBK,OAASC,EAAIP,EAAMC,KAGnBmB,MAAMR,EAAOE,KAGhBV,QA3CLiB,GAAW9B,UAAUC,OAAS,GAAsBgB,SAAjBjB,UAAU,GAAmBA,UAAU,MAE1EW,EAASf,OAAOmC,OAAO,YA4CpBpC,MAAamC,MAEdtB,OACEM,MACDE,OACCI,yVChEWY,wBAMJC,MAAMC,4EACVC,QAAU5B,OAEX6B,YACAF,EAAQE,OAASF,EAAQE,OAAS,GAAKF,EAAQE,OAAS,GAChDF,EAAQE,MAER,OAGPF,eACME,gBACQF,EAAQG,gBAAiB,MAGtCC,GAA6B,UAC9BC,oBAAoD,EAA7BD,GAAmCzB,KAAKqB,QAAQE,MAAQ,SAE/EI,iBAAkB,OAClBC,gBAEDR,YAAgBT,YACXS,KAAOA,MACT,IAAIA,OACD,IAAIS,sCAGP7B,6CAOL8B,GACEA,OACKC,YAAYD,GACV9B,KAAKqB,QAAQG,mBACfO,YAAY/B,KAAKqB,QAAQG,oBAEzBQ,aAAahC,KAAKoB,KAAK,mCAI5Ba,QACCC,gBAAgBD,oDAGEX,SAAQ3B,wEACP2B,SAAQnB,iEAMjB2B,oBACR,IAAIK,SAAQ,SAACC,EAASC,KACpBjB,KAAKL,QAAQ,SAACuB,GACXA,EAAIR,KAAOA,KACHQ,OAGT,8DAICC,MACNC,GAAkBD,EAASnD,OAC7BqD,EAAOD,EAAkBxC,KAAK0B,8BACpB,MACPgB,KAAKC,MAAMF,wCAIRH,mBACLX,gBAAkBW,KACjBG,GAAOzC,KAAK4C,eAAeN,EAAIC,eAEhCjB,QAAQf,KAAK,SAAUkC,cAEjB,aACFnB,QAAQf,KAAK,WAAY+B,IAC/BG,uCAGMX,mBACJe,kBAAkBf,GAAIgB,KAAK,SAACR,KACxBN,aAAaM,KACnBS,MAAM,SAACC,QACA,IAAInB,OAAMmB,6CAIPf,MACPgB,aACQjD,KAAK2B,gBAAgBY,gBACvBN,EAAOiB,cAGdtB,aAAa7B,KAAKkD,QAElB3B,QAAQf,KAAK,SAAUP,KAAK4B,cAE7BK,EAAOkB,kBACFpB,YAAYE,EAAOkB,mBAEnB7B,QAAQf,KAAK,WAAYP,KAAK4B,cAGnCK,EAAOmB,SAAU,IACa,kBAAnBnB,GAAOmB,cAGR,IAAIvB,4BAA2BI,EAAOiB,8BAFrCE"}